<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Policy Proposal | PolityxMap</title>
  <meta name="description" content="View detailed healthcare policy proposal information with PolityxMap.">
  <link rel="stylesheet" href="/css/darktemplate.webflow.eb6e6d95d.css">
  <link rel="stylesheet" href="/css/fonts.css">
  <script src="/js/jquery-3.5.1.min.dc5e7f18c8_site_61113c4e9f23df1e7f554117.js"></script>
  <script src="/js/webflow.72248eaed.js"></script>
  <script src="/proposals.js"></script>
</head>
<body>
  <div class="proposal-container">
    <div class="proposal-header">
      <a href="/proposals.html" class="back-link">‚Üê Back to all proposals</a>
      <h1 id="proposal-title">Loading proposal...</h1>
      <h2 id="proposal-location"></h2>
    </div>
    
    <div class="proposal-content">
      <div class="proposal-section">
        <h3>Issue</h3>
        <p id="proposal-description"></p>
      </div>
      
      <div class="proposal-section">
        <h3>Background</h3>
        <p id="proposal-background"></p>
      </div>
      
      <div class="proposal-section">
        <h3>Policy Proposal</h3>
        <p id="proposal-policy"></p>
      </div>
      
      <div class="proposal-section">
        <h3>Stakeholders</h3>
        <p id="proposal-stakeholders"></p>
      </div>
      
      <div class="proposal-section">
        <h3>Costs</h3>
        <p id="proposal-costs"></p>
      </div>
      
      <div class="proposal-section">
        <h3>Metrics</h3>
        <p id="proposal-metrics"></p>
      </div>
      
      <div class="proposal-section">
        <h3>Timeline</h3>
        <p id="proposal-timeline"></p>
      </div>
      
      <div class="proposal-section">
        <h3>Tags</h3>
        <div id="proposal-tags"></div>
      </div>
    </div>
  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Get the slug from the URL path
      const pathSegments = window.location.pathname.split('/');
      const slug = pathSegments[pathSegments.length - 1].replace('.html', '');
      
      // Find the proposal by slug
      const proposal = window.ProposalsCMS.findProposalBySlug(slug);
      
      if (proposal) {
        // Update page title
        document.title = `${proposal.city} Healthcare Proposal | PolityxMap`;
        
        // Update meta description
        const metaDescription = document.querySelector('meta[name="description"]');
        if (metaDescription) {
          metaDescription.setAttribute('content', proposal.description);
        }
        
        // Populate proposal data
        document.getElementById('proposal-title').textContent = proposal.healthcareIssue || proposal.issue;
        document.getElementById('proposal-location').textContent = `${proposal.city}, ${proposal.state}`;
        document.getElementById('proposal-description').textContent = proposal.description;
        document.getElementById('proposal-background').textContent = proposal.background;
        document.getElementById('proposal-policy').textContent = proposal.policy;
        document.getElementById('proposal-stakeholders').textContent = proposal.stakeholders;
        document.getElementById('proposal-costs').textContent = proposal.costs;
        document.getElementById('proposal-metrics').textContent = proposal.metrics;
        document.getElementById('proposal-timeline').textContent = proposal.timeline;
        
        // Create tags
        const tagsContainer = document.getElementById('proposal-tags');
        if (proposal.tags && proposal.tags.length > 0) {
          proposal.tags.forEach(tag => {
            const tagElement = document.createElement('span');
            tagElement.className = 'proposal-tag';
            tagElement.textContent = tag;
            tagsContainer.appendChild(tagElement);
          });
        }
      } else {
        // Redirect to error page if proposal not found
        window.location.replace('/error.html');
      }
      
      // Listen for proposal updates
      window.addEventListener('proposals-updated', function() {
        // Reload the proposal data
        const updatedProposal = window.ProposalsCMS.findProposalBySlug(slug);
        if (updatedProposal) {
          // Update the page with new data
          document.getElementById('proposal-title').textContent = updatedProposal.healthcareIssue || updatedProposal.issue;
          document.getElementById('proposal-location').textContent = `${updatedProposal.city}, ${updatedProposal.state}`;
          document.getElementById('proposal-description').textContent = updatedProposal.description;
          document.getElementById('proposal-background').textContent = updatedProposal.background;
          document.getElementById('proposal-policy').textContent = updatedProposal.policy;
          document.getElementById('proposal-stakeholders').textContent = updatedProposal.stakeholders;
          document.getElementById('proposal-costs').textContent = updatedProposal.costs;
          document.getElementById('proposal-metrics').textContent = updatedProposal.metrics;
          document.getElementById('proposal-timeline').textContent = updatedProposal.timeline;
          
          // Update tags
          const tagsContainer = document.getElementById('proposal-tags');
          tagsContainer.innerHTML = '';
          if (updatedProposal.tags && updatedProposal.tags.length > 0) {
            updatedProposal.tags.forEach(tag => {
              const tagElement = document.createElement('span');
              tagElement.className = 'proposal-tag';
              tagElement.textContent = tag;
              tagsContainer.appendChild(tagElement);
            });
          }
        } else {
          // Redirect to error page if proposal was deleted
          window.location.replace('/error.html');
        }
      });
    });
  </script>
</body>
</html>