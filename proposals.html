<!DOCTYPE html>
<html class="w-mod-js w-mod-ix wf-dmsans-n5-active wf-dmsans-n7-active wf-dmsans-n4-active wf-active" data-wf-domain="darktemplate.webflow.io" data-wf-locale="en" data-wf-page="61113c4e9f23df42e2554109" data-wf-site="61113c4e9f23df1e7f554117" data-wf-status="1" lang="en">
<head>
  <style>.wf-force-outline-none[tabindex="-1"]:focus{outline:none;}</style>
  <meta charset="utf-8"/>
  <title>Policy Proposals | PolityxMap</title>
  <meta content="Explore healthcare policy proposals with PolityxMap. Search, filter, and sort proposals by region, issue area, and impact potential." name="description"/>
  <meta content="Policy Proposals | PolityxMap" property="og:title"/>
  <meta content="Explore healthcare policy proposals with PolityxMap. Search, filter, and sort proposals by region, issue area, and impact potential." property="og:description"/>
  <meta content="https://cdn.prod.website-files.com/61113c4e9f23df1e7f554117/6116f87a2ba0ad7e5947b25e_featured-image-dark-template.png" property="og:image"/>
  <meta content="Policy Proposals | PolityxMap" property="twitter:title"/>
  <meta content="Explore healthcare policy proposals with PolityxMap. Search, filter, and sort proposals by region, issue area, and impact potential." property="twitter:description"/>
  <meta content="https://cdn.prod.website-files.com/61113c4e9f23df1e7f554117/6116f87a2ba0ad7e5947b25e_featured-image-dark-template.png" property="twitter:image"/>
  <meta content="website" property="og:type"/>
  <meta content="summary_large_image" name="twitter:card"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <meta content="Webflow" name="generator"/>
  <link href="https://cdn.prod.website-files.com/61113c4e9f23df1e7f554117/css/darktemplate.webflow.eb6e6d95d.css" rel="stylesheet" type="text/css"/>
  <link href="https://fonts.googleapis.com" rel="preconnect"/>
  <link crossorigin="anonymous" href="https://fonts.gstatic.com" rel="preconnect"/>
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <link href="https://fonts.googleapis.com/css?family=DM+Sans:regular,500,700" media="all" rel="stylesheet"/>
  <script type="text/javascript">WebFont.load({  google: {    families: ["DM Sans:regular,500,700"]  }});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
    <!-- Favicon implementation -->
  <link rel="icon" type="image/svg+xml" href="img/PolityxFavicon.svg">
  <link rel="icon" type="image/png" href="img/PolityxFavicon.png">
  <link rel="apple-touch-icon" href="img/PolityxFavicon.png">
  <link rel="shortcut icon" type="image/x-icon" href="img/PolityxFavicon.png">
  <!-- Supabase Client -->
  <script src="js/supabase-client.js"></script>
  <!-- Includes script for header and footer -->
  <script src="includes.js"></script>
  <!-- Unified Proposals System -->
  <script src="proposals.js"></script>
  <script src="data-migration.js"></script>
  <!-- Proposals Router Script -->
  <script src="proposals-router.js"></script>
  <style>
  .w-webflow-badge{
    display:none !important;
  }
  
  .bg-gradient-blur-wrapper {
    position: absolute;
    width: 700px;
    height: 700px;
    z-index: 0;
    opacity: 0.3;
  }
  
  .proposals-heading {
    font-size: 56px;
    line-height: 1.1;
    font-weight: 700;
    color: #fff;
    margin-bottom: 20px;
  }
  
  .proposals-accent {
    color: #8A67FF;
  }
  
  .proposals-description {
    font-size: 18px;
    line-height: 1.6;
    color: rgba(255, 255, 255, 0.9);
    margin-bottom: 30px;
  }
  
  .filter-container {
    background-color: rgba(28, 26, 36, 0.8);
    border-radius: 15px;
    padding: 20px;
    margin-bottom: 40px;
    backdrop-filter: blur(10px);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
  }
  
  .filter-title {
    font-size: 18px;
    font-weight: 600;
    color: #fff;
    margin-bottom: 15px;
  }
  
  .search-input {
    background-color: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 10px;
    color: #fff;
    padding: 12px 15px;
    width: 100%;
    margin-bottom: 20px;
    font-family: 'DM Sans', sans-serif;
    transition: all 0.3s ease;
  }
  
  .search-input:focus {
    background-color: rgba(255, 255, 255, 0.15);
    border-color: rgba(138, 103, 255, 0.5);
    outline: none;
  }
  
  .search-input::placeholder {
    color: rgba(255, 255, 255, 0.5);
  }
  
  .tag-filter {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 20px;
  }
  
  .tag {
    display: inline-block;
    padding: 8px 16px;
    border-radius: 30px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .tag.healthcare {
    background-color: rgba(138, 103, 255, 0.2);
    color: #8A67FF;
  }
  
  .tag.healthcare.active, .tag.healthcare:hover {
    background-color: rgba(138, 103, 255, 0.4);
  }
  
  .tag.maternal {
    background-color: rgba(56, 182, 255, 0.2);
    color: #38B6FF;
  }
  
  .tag.maternal.active, .tag.maternal:hover {
    background-color: rgba(56, 182, 255, 0.4);
  }
  
  .tag.mental {
    background-color: rgba(255, 103, 132, 0.2);
    color: #FF6784;
  }
  
  .tag.mental.active, .tag.mental:hover {
    background-color: rgba(255, 103, 132, 0.4);
  }
  
  .tag.pediatrics {
    background-color: rgba(103, 255, 178, 0.2);
    color: #67FFB2;
  }
  
  .tag.pediatrics.active, .tag.pediatrics:hover {
    background-color: rgba(103, 255, 178, 0.4);
  }
  
  .tag.rural {
    background-color: rgba(255, 181, 103, 0.2);
    color: #FFB567;
  }
  
  .tag.rural.active, .tag.rural:hover {
    background-color: rgba(255, 181, 103, 0.4);
  }
  
  .tag.urban {
    background-color: rgba(181, 103, 255, 0.2);
    color: #B567FF;
  }
  
  .tag.urban.active, .tag.urban:hover {
    background-color: rgba(181, 103, 255, 0.4);
  }
  
  .sort-filter {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .sort-select {
    background-color: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 10px;
    color: #fff;
    padding: 12px 15px;
    width: 200px;
    font-family: 'DM Sans', sans-serif;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg width='16' height='9' viewBox='0 0 16 9' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M8 9L0 0L16 0L8 9Z' fill='white' fill-opacity='0.5'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 15px center;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .sort-select:focus {
    background-color: rgba(255, 255, 255, 0.15);
    border-color: rgba(138, 103, 255, 0.5);
    outline: none;
  }
  
  .proposal-card {
    background-color: #1C1A24;
    border-radius: 18px;
    overflow: hidden;
    text-decoration: none;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    padding: 30px;
    margin-bottom: 30px;
    cursor: pointer;
    display: block;
    text-align: left;
  }
  
  .proposal-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  }
  
  .proposal-tag {
    display: inline-block;
    padding: 8px 16px;
    border-radius: 30px;
    font-size: 14px;
    font-weight: 500;
    margin-bottom: 20px;
    text-align: left;
  }
  
  .proposal-title {
    margin-top: 0;
    margin-bottom: 16px;
    color: #ffffff;
    font-size: 24px;
    font-weight: 700;
    line-height: 1.3;
    text-align: left;
  }
  
  .proposal-description {
    margin-bottom: 20px;
    color: rgba(255, 255, 255, 0.7);
    font-size: 16px;
    line-height: 1.6;
    text-align: left;
  }
  
  .proposal-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .proposal-location {
    color: rgba(255, 255, 255, 0.5);
    font-size: 14px;
  }
  
  .proposal-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 20px;
  }
  
  .proposal-tag-item {
    display: inline-block;
    padding: 5px 10px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
    background-color: rgba(56, 182, 255, 0.1);
    color: #38B6FF;
  }
  
  .empty-state {
    text-align: center;
    padding: 60px 20px;
    background-color: rgba(28, 26, 36, 0.5);
    border-radius: 15px;
    margin-bottom: 30px;
  }
  
  .empty-state-title {
    font-size: 24px;
    font-weight: 700;
    color: #fff;
    margin-bottom: 10px;
  }
  
  .empty-state-description {
    font-size: 16px;
    color: rgba(255, 255, 255, 0.7);
    max-width: 500px;
    margin: 0 auto;
  }
</style>

<body class="bg-neutral-800">
  <div class="page-wrapper">
    <!-- Header will be inserted here by the includes.js script -->
    <div id="site-header"></div>
    
    <!-- Hero Section -->
    <section class="section" style="padding-top: 180px; position: relative;">
      <div class="bg-gradient-blur-wrapper" style="top: 100px; left: -300px; transform: rotate(15deg);">
        <div class="bg-gradient-blur-circle-3"></div>
        <div class="bg-gradient-blur-circle-2"></div>
        <div class="bg-gradient-blur-circle-1"></div>
      </div>
      
      <div class="bg-gradient-blur-wrapper" style="bottom: -300px; right: -300px; transform: rotate(60deg);">
        <div class="bg-gradient-blur-circle-3"></div>
        <div class="bg-gradient-blur-circle-2 blue"></div>
        <div class="bg-gradient-blur-circle-1 purple"></div>
      </div>
      
      <div class="container-medium-940px w-container" style="position: relative; z-index: 1; text-align: center;">
        <!-- Announcement Banner -->
        <div class="home-hero-featured-message-wrapper" data-w-id="448f5ead-3667-0bad-b1a4-a6038870800b" style="transform: translate3d(0px, 0%, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg); opacity: 1; transform-style: preserve-3d; margin-bottom: 30px; display: inline-block;">
          <div class="home-hero-featured-message-content">
            <a class="home-hero-featured-message-link w-inline-block" data-w-id="5747d66c-b4ac-690f-6026-662ab3648be2" href="#">
              <div class="home-hero-featured-message-tag">New</div>
              <div class="home-hero-featured-message-text">Healthcare Policy Database Live</div>
              <div class="home-hero-featured-message-icon"></div>
            </a>
            <div class="home-hero-featured-message-blur"></div>
          </div>
        </div>
        
        <div style="max-width: 800px; margin: 0 auto; text-align: center;">
          <h1 class="proposals-heading">Healthcare <span class="proposals-accent">Policy Proposals</span></h1>
          <p class="proposals-description">Explore innovative policy solutions to healthcare challenges around the world. Filter by region, issue area, or impact potential to find the proposals most relevant to your work.</p>
        </div>
        
        <!-- Filters -->
        <div class="filter-container">
          <div class="filter-title">Search and Filter</div>
          
          <input type="text" class="search-input" id="proposal-search" placeholder="Search by keyword, location, or topic">
          
          <div class="filter-title">Filter by Tag</div>
          <div class="tag-filter" id="tag-filter">
            <div class="tag healthcare" data-tag="all">All</div>
            <div class="tag maternal" data-tag="Telehealth">Telehealth</div>
            <div class="tag rural" data-tag="Rural Health">Rural Health</div>
            <div class="tag healthcare" data-tag="Healthcare Access">Healthcare Access</div>
            <div class="tag maternal" data-tag="Maternal Health">Maternal Health</div>
            <div class="tag mental" data-tag="Mental Health">Mental Health</div>
          </div>
          
          <div class="sort-filter">
            <div class="filter-title" style="margin-bottom: 0;">Sort by</div>
            <select class="sort-select" id="sort-select">
              <option value="latest">Latest First</option>
              <option value="name">Name (A-Z)</option>
              <option value="location">Location (A-Z)</option>
            </select>
          </div>
        </div>
        
        <!-- Proposals Container -->
        <div id="proposals-container">
          <!-- Proposals will be loaded here from our data source -->
        </div>
      </div>
    </section>
    
    <!-- Footer will be inserted here by the includes.js script -->
    <div id="site-footer"></div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Load all proposals
      loadProposals();
      
      // Set up event listeners
      setupEventListeners();
      
      // Listen for proposal updates
      window.addEventListener('proposals-updated', function() {
        loadProposals();
      });
      
      // Enforce city-only URL format for all proposal links
      function updateAllProposalLinks() {
        console.log("Updating all proposal links to city-only format");
        document.querySelectorAll('a[href^="/proposals/"]').forEach(link => {
          const href = link.getAttribute('href');
          console.log("Found proposal link:", href);
          
          // Extract just the city name from any format
          let newHref = href;
          
          // If link has a dash (indicating city-state format), use only the first part
          if (href.includes('-') && !href.endsWith('/')) {
            const parts = href.split('/').pop().split('-');
            const citySlug = parts[0];
            newHref = `/proposals/${citySlug}`;
            console.log(`Converting ${href} to ${newHref}`);
          }
          
          // Remove any .html extensions if present
          if (newHref.endsWith('.html')) {
            newHref = newHref.replace('.html', '');
            console.log(`Removing .html extension: ${newHref}`);
          }
          
          // Ensure trailing slash for clean URLs
          if (!newHref.endsWith('/')) {
            newHref = `${newHref}/`;
            console.log(`Adding trailing slash: ${newHref}`);
          }
          
          // Update the link
          if (newHref !== href) {
            console.log(`Updating link from ${href} to ${newHref}`);
            link.setAttribute('href', newHref);
          }
        });
      }
      
      // Run link updater initially
      updateAllProposalLinks();
      
      // Run link updater after any dynamic content loads
      setTimeout(updateAllProposalLinks, 1000);
      
      // Also patch the window.location.href call in onclick handlers
      // This fixes any dynamically generated cards
      const originalCreateElement = document.createElement;
      document.createElement = function(tag) {
        const element = originalCreateElement.call(document, tag);
        
        if (tag.toLowerCase() === 'div') {
          const originalSetAttribute = element.setAttribute;
          
          // Watch for onclick handlers being set
          element.setAttribute = function(attr, value) {
            if (attr === 'onclick' && typeof value === 'string' && 
                value.includes('window.location.href') && 
                value.includes('/proposals/')) {
              
              // Make sure URLs use city-only format
              const modifiedValue = value.replace(/\/proposals\/[^'"]+-[^'"]+/g, 
                                               (match) => `/proposals/${match.split('-')[0].split('/').pop()}`);
              
              console.log(`Modified onclick handler: ${value} -> ${modifiedValue}`);
              return originalSetAttribute.call(this, attr, modifiedValue);
            }
            
            return originalSetAttribute.call(this, attr, value);
          };
        }
        
        return element;
      };
    });
    
    // Function to load proposals from our data source
    async function loadProposals() {
      const container = document.getElementById('proposals-container');
      if (!container) return;
      
      // Clear the container
      container.innerHTML = '';
      
      // Get proposals from our data source
      let proposals = [];
      
      try {
        // Use only one data source - this prevents duplication
        if (window.ProposalsCMS && typeof window.ProposalsCMS.getAll === 'function') {
          // Use the ProposalsCMS if available
          proposals = await window.ProposalsCMS.getAll();
        } else {
          // Fall back to direct file loading only if ProposalsCMS is not available
          try {
            const response = await fetch('/data/proposals.json');
            if (response.ok) {
              proposals = await response.json();
            } else {
              // Try to import from JS module only as a last resort
              try {
                console.warn('Unable to load proposals.json, attempting module import');
                const module = await import('/data/proposals.js');
                proposals = module.proposals;
              } catch (err) {
                console.error('Error importing proposals module:', err);
                renderEmptyState(container);
                return;
              }
            }
          } catch (error) {
            console.error('Error loading proposals data:', error);
            renderEmptyState(container);
            return;
          }
        }
        
        // Log how many proposals were loaded for debugging
        console.log(`Loaded ${proposals.length} proposals`);
        
        // Filter proposals based on search terms and tags
        const searchTerm = (document.getElementById('proposal-search')?.value || '').toLowerCase();
        const activeTag = document.querySelector('.tag.active')?.getAttribute('data-tag') || 'all';
        const sortOption = document.getElementById('sort-select')?.value || 'latest';
        
        // Apply filters
        let filteredProposals = proposals;
        
        // Apply search filter if search term exists
        if (searchTerm) {
          filteredProposals = filteredProposals.filter(proposal => {
            // Search in multiple fields
            const searchFields = [
              proposal.name || '',
              proposal.description || '',
              proposal.city || '',
              proposal.state || '',
              proposal.country || '',
              ...(proposal.tags || [])
            ].map(field => (typeof field === 'string' ? field.toLowerCase() : ''));
            
            // Check if any field contains the search term
            return searchFields.some(field => field.includes(searchTerm));
          });
        }
        
        // Apply tag filter if not "all"
        if (activeTag && activeTag !== 'all') {
          filteredProposals = filteredProposals.filter(proposal => {
            const tags = proposal.tags || [];
            return tags.some(tag => tag.toLowerCase() === activeTag.toLowerCase());
          });
        }
        
        // Apply sorting
        switch (sortOption) {
          case 'name':
            filteredProposals.sort((a, b) => (a.name || '').localeCompare(b.name || ''));
            break;
          case 'location':
            filteredProposals.sort((a, b) => (a.city || '').localeCompare(b.city || ''));
            break;
          case 'latest':
          default:
            // Latest proposals first (no specific sorting needed as they should be in order)
            break;
        }
        
        // Render the filtered proposals
        if (filteredProposals.length > 0) {
          renderProposals(filteredProposals, container);
        } else {
          renderNoResultsState(container);
        }
      } catch (error) {
        console.error('Error loading proposals:', error);
        renderEmptyState(container);
      }
    }
    
    // Function to render proposals
    function renderProposals(proposals, container) {
      proposals.forEach(proposal => {
        // Get title from name or healthcareIssue for backward compatibility
        const title = proposal.name || proposal.healthcareIssue || 'Healthcare Proposal';
        
        // Generate URL slug - ONLY USE CITY NAME
        const citySlug = proposal.city ? proposal.city.toLowerCase().replace(/\s+/g,'-').replace(/[^\w-]/g, '') : '';
        
        // Get tags
        const tags = proposal.tags || [];
        
        // Create card element
        const card = document.createElement('div');
        card.className = 'proposal-card';
        card.style.textAlign = 'left';
        card.onclick = function() {
          window.location.href = `/proposals/${citySlug}/`;
        };
        
        // Create tag elements
        const tagElements = tags.map(tag => {
          let tagClass = 'healthcare';
          if (tag.toLowerCase().includes('telehealth')) tagClass = 'maternal';
          else if (tag.toLowerCase().includes('rural')) tagClass = 'rural';
          else if (tag.toLowerCase().includes('maternal')) tagClass = 'maternal';
          else if (tag.toLowerCase().includes('mental')) tagClass = 'mental';
          else if (tag.toLowerCase().includes('access')) tagClass = 'healthcare';
          
          return `<div class="proposal-tag-item ${tagClass}">${tag}</div>`;
        }).join('');
        
        // Set card content
        card.innerHTML = `
          <div class="proposal-tag healthcare" style="text-align: left;">${tags[0] || 'Healthcare'}</div>
          <h3 class="proposal-title" style="text-align: left;">${title}</h3>
          <p class="proposal-description" style="text-align: left;">${proposal.description || ''}</p>
          <div class="proposal-footer" style="text-align: left;">
            <div class="proposal-location">${proposal.city}, ${proposal.state || ''} ${proposal.country || ''}</div>
          </div>
          <div class="proposal-tags" style="text-align: left;">
            ${tagElements}
          </div>
        `;
        
        // Add to container
        container.appendChild(card);
      });
    }
    
    // Function to render empty state
    function renderEmptyState(container) {
      container.innerHTML = `
        <div class="empty-state">
          <h3 class="empty-state-title">No proposals available</h3>
          <p class="empty-state-description">There are no healthcare policy proposals in our database yet. Please check back soon or submit a proposal through the admin portal.</p>
        </div>
      `;
    }
    
    // Function to render no results state
    function renderNoResultsState(container) {
      container.innerHTML = `
        <div class="empty-state">
          <h3 class="empty-state-title">No matching proposals found</h3>
          <p class="empty-state-description">Your search criteria didn't match any proposals. Try adjusting your filters or search terms.</p>
        </div>
      `;
    }
    
    // Set up event listeners for search, filter, and sort
    function setupEventListeners() {
      // Search input
      const searchInput = document.getElementById('proposal-search');
      if (searchInput) {
        searchInput.addEventListener('input', function() {
          loadProposals();
        });
      }
      
      // Tag filters
      const tagFilters = document.querySelectorAll('.tag');
      tagFilters.forEach(tag => {
        tag.addEventListener('click', function() {
          // Remove active class from all tags
          tagFilters.forEach(t => t.classList.remove('active'));
          
          // Add active class to clicked tag
          this.classList.add('active');
          
          // Reload proposals with filter
          loadProposals();
        });
      });
      
      // Set "All" tag as active by default
      const allTag = document.querySelector('.tag[data-tag="all"]');
      if (allTag) {
        allTag.classList.add('active');
      }
      
      // Sort select
      const sortSelect = document.getElementById('sort-select');
      if (sortSelect) {
        sortSelect.addEventListener('change', function() {
          loadProposals();
        });
      }
    }
  </script>
</body>
</html>