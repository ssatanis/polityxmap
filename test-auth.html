<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Authentication Test | PolityxMap</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #13111A;
      color: white;
      padding: 40px;
      text-align: center;
    }
    .test-container {
      max-width: 600px;
      margin: 0 auto;
      background: #1A1A1A;
      padding: 30px;
      border-radius: 20px;
    }
    button {
      background: linear-gradient(90deg, #38B6FF, #8A67FF);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      margin: 10px;
      cursor: pointer;
      font-size: 16px;
    }
    button:hover {
      opacity: 0.9;
    }
    .status {
      margin: 20px 0;
      padding: 15px;
      border-radius: 8px;
      font-weight: bold;
    }
    .authenticated {
      background: rgba(76, 175, 80, 0.2);
      border: 1px solid #4CAF50;
      color: #4CAF50;
    }
    .not-authenticated {
      background: rgba(244, 67, 54, 0.2);
      border: 1px solid #f44336;
      color: #f44336;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <h1>üîê Authentication System Test</h1>
    
    <div id="auth-status" class="status">Checking...</div>
    
    <div>
      <button onclick="checkAuth()">Check Auth Status</button>
      <button onclick="clearAuth()">Clear Auth</button>
      <button onclick="setAuth()">Set Auth (Simulate Login)</button>
      <button onclick="testAdminAccess()">Test Admin Access</button>
      <button onclick="testLoginPage()">Go to Login</button>
    </div>
    
    <div style="margin-top: 30px; text-align: left;">
      <h3>Test Results:</h3>
      <pre id="test-results" style="background: #000; padding: 15px; border-radius: 8px; white-space: pre-wrap;"></pre>
    </div>
  </div>

  <script>
    function log(message) {
      const results = document.getElementById('test-results');
      const timestamp = new Date().toLocaleTimeString();
      results.textContent += `[${timestamp}] ${message}\n`;
      console.log(message);
    }

    function checkAuth() {
      const auth = localStorage.getItem('adminAuthenticated') === 'true';
      const lastActivity = localStorage.getItem('lastActivity');
      const now = Date.now();
      const last = parseInt(lastActivity || '0', 10);
      const timeLeft = Math.max(0, (10*60*1000) - (now - last));
      
      const status = document.getElementById('auth-status');
      
      if (auth && timeLeft > 0) {
        status.className = 'status authenticated';
        status.textContent = `‚úÖ AUTHENTICATED (Session expires in ${Math.ceil(timeLeft/1000/60)} minutes)`;
        log(`Authentication: VALID (${Math.ceil(timeLeft/1000/60)} minutes remaining)`);
      } else {
        status.className = 'status not-authenticated';
        status.textContent = '‚ùå NOT AUTHENTICATED';
        log('Authentication: INVALID or EXPIRED');
      }
    }

    function clearAuth() {
      localStorage.removeItem('adminAuthenticated');
      localStorage.removeItem('lastActivity');
      log('Authentication tokens cleared');
      checkAuth();
    }

    function setAuth() {
      localStorage.setItem('adminAuthenticated', 'true');
      localStorage.setItem('lastActivity', Date.now().toString());
      log('Authentication tokens set (simulating login)');
      checkAuth();
    }

    function testAdminAccess() {
      log('Testing admin access...');
      window.open('/admin.html', '_blank');
    }

    function testLoginPage() {
      log('Opening login page...');
      window.open('/login.html', '_blank');
    }

    // Initial check
    checkAuth();
    
    log('Authentication test page loaded');
    log('Password for login: Polityx76092');
  </script>
</body>
</html> 